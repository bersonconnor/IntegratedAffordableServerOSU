{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/Connor/Demo_OSU_Filemanager/app/src/pages/MainPages/OrganizationPages/JoinGroup/index.js\";\nimport React, { Component } from \"react\";\nimport ReactTable from \"react-table\";\nimport CollapseWithHeader from \"../../../../components/CollapseWithHeader\";\nimport { UserIDContext } from \"../../MainPagesRoutingContainer/index.tsx\";\nimport \"../../../../styles/buttons.css\";\nimport \"./scss/join-group.scss\";\nimport \"react-table/react-table.css\";\nimport swal from \"sweetalert\";\n\nvar FormGroup = ({\n  labelName,\n  value,\n  handleChange\n}) => {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 12,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 13,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: labelName.replace(/\\s+/g, \"-\"),\n    className: \"col-2 col-form-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 14,\n      columnNumber: 7\n    }\n  }, labelName), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-8\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    id: labelName.replace(/\\s+/g, \"-\"),\n    value: value,\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 21,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 7\n    }\n  }));\n};\n\nvar userID = 0;\nvar call = true;\nvar insert = true;\n\nvar UserIDVal = ID => {\n  userID = ID.ID;\n  return null;\n};\n\nclass JoinGroup extends Component {\n  constructor(props) {\n    super(props);\n    this.REACT_APP_AF_BACKEND_URL = process.env.REACT_APP_AF_BACKEND_URL || window.REACT_APP_AF_BACKEND_URL;\n\n    this.changeRepresentation = rowNum => {\n      this.state.representing = this.state.charityDetailsRow[rowNum];\n      localStorage.setItem(\"representing\", JSON.stringify(this.state.representing));\n      swal(this.state.representing.name, \"You are now representing this organization\");\n      var r = localStorage.getItem(\"representing\");\n      console.log(r);\n    };\n\n    this.removeMember = rowNum => {\n      console.log(rowNum);\n      swal(this.state.charityDetailsRow[rowNum].name, \"Do you wish to remove this organization?\", {\n        buttons: [\"Cancel\", true]\n      }).then(willRemove => {\n        if (willRemove) {\n          var data = new FormData();\n          data.append(\"orgID\", this.state.charityDetailsRow[rowNum].id);\n          data.append(\"admin\", this.state.charityDetailsRow[rowNum].role === \"Admin\" ? \"1\" : \"0\");\n          data.append(\"userID\", userID);\n          fetch(this.REACT_APP_AF_BACKEND_URL + \"/joinGroup/removeMember\", {\n            method: \"POST\",\n            body: data\n          }).then(response => {\n            if (response.ok) {\n              swal(\"You have been removed from the organization!\", {\n                icon: \"success\"\n              });\n            } else {\n              swal(\"Failure: Group already removed\", {\n                icon: \"warning\"\n              });\n            }\n          }).then(() => {});\n        }\n      });\n    };\n\n    this.joinedOrganizations = e => {\n      if (call && userID != null && userID != 0) {\n        call = false;\n        var data = new FormData();\n        data.append(\"userID\", userID);\n        fetch(this.REACT_APP_AF_BACKEND_URL + \"/joinGroup/affiliations\", {\n          method: \"POST\",\n          body: data\n        }).then(response => {\n          if (response.ok) return response.json();\n        }).then(resData => {\n          if (resData != null && resData.orgs == null) {\n            var charityVals = [];\n\n            for (var i = 0; i < resData.length; i++) {\n              charityVals.push({\n                name: resData[i].name,\n                verified: resData[i].verified ? \"Yes\" : \"No\",\n                role: resData[i].role,\n                date: resData[i].date,\n                id: resData[i].orgID\n              });\n            }\n\n            this.setState({\n              charityDetailsRow: charityVals,\n              representing: JSON.parse(localStorage.getItem(\"representing\")) || charityVals[0]\n            });\n            console.log(JSON.parse(localStorage.getItem(\"representing\")));\n          } else {}\n        });\n      }\n    };\n\n    this.handleSearchOrganizations = e => {\n      console.log(\"Charity search\");\n      console.log(document.getElementById(\"Charity-Name\").value);\n\n      if (document.getElementById(\"Charity-Name\") != null) {\n        var searchVal = document.getElementById(\"Charity-Name\").value;\n        var data = new FormData();\n        data.append(\"orgName\", searchVal);\n        fetch(this.REACT_APP_AF_BACKEND_URL + \"/joinGroup/searchOrg\", {\n          method: \"POST\",\n          body: data\n        }).then(response => {\n          if (response.ok) return response.json();\n        }).then(resData => {\n          if (resData != null) {\n            console.log(\"Here are your results\");\n            this.displayOrganizations(resData.orgName);\n            this.render();\n          } else {\n            console.log(\"No organizations matched your search\");\n          }\n        });\n      }\n    };\n\n    this.displayOrganizations = orgs => {\n      console.log(orgs);\n      var orgValues = [];\n\n      for (var i = 0; i < orgs.length; i++) {\n        orgValues.push({\n          name: orgs[i].name,\n          websiteUrl: orgs[i].websiteUrl,\n          phone: orgs[i].phone,\n          id: orgs[i].ID\n        });\n      }\n\n      console.log(orgValues);\n      this.setState({\n        orgsList: orgValues\n      });\n      console.log(\"after displaying orgs\", this.state.orgsList);\n      this.render();\n    };\n\n    this.handleChange = key => {\n      return event => {\n        this.setState({\n          [key]: event.target.value\n        });\n      };\n    };\n\n    this.handleCharityClick = rowNum => {\n      swal(this.state.orgsList[rowNum].name, \"Do you wish to join this organization?\", {\n        buttons: [\"Cancel\", true]\n      }).then(willJoin => {\n        if (willJoin) {\n          var data = new FormData();\n          data.append(\"orgID\", this.state.orgsList[rowNum].id);\n          data.append(\"userID\", userID);\n          fetch(this.REACT_APP_AF_BACKEND_URL + \"/joinGroup/addMember\", {\n            method: \"POST\",\n            body: data\n          }).then(response => {\n            if (response.ok) {\n              swal(\"You have joined the group!\", {\n                icon: \"success\"\n              }); //return response.json();\n            } else {\n              swal(\"Failure: Group already joined\", {\n                icon: \"warning\"\n              });\n            }\n          }).then(() => {});\n        }\n      });\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n    };\n\n    this.state = {\n      orgsList: [{\n        name: \"\",\n        websiteUrl: \"\",\n        phone: \"\",\n        id: 0\n      }],\n      shouldHide: true,\n      charityName: \"\",\n      charityDetailsRow: [{\n        name: \"\",\n        verified: \"\",\n        role: \"\",\n        date: \"\",\n        id: 0\n      }],\n      representing: {\n        name: \"\",\n        verified: \"\",\n        role: \"\",\n        date: \"\",\n        id: 0\n      }\n    };\n    this.displayOrganizations = this.displayOrganizations.bind(this);\n    this.joinedOrganizations = this.joinedOrganizations.bind(this);\n  }\n  /*Helper Functions*/\n  //Updates state with what company they are representing\n\n\n  componentDidMount() {\n    if (!window.location.hash) {\n      //setting window location\n      window.location = window.location + \"#loaded\"; //using reload() method to reload web page\n      // window.location.reload();\n    }\n  }\n\n  componentDidUpdate() {\n    this.joinedOrganizations();\n  }\n\n  render() {\n    var orgResult = this.state.orgsList.map(function (current_info) {\n      return current_info ? /*#__PURE__*/React.createElement(\"li\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 29\n        }\n      }, current_info) : null;\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      className: \"col\",\n      onSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(UserIDContext.Consumer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 11\n      }\n    }, value => /*#__PURE__*/React.createElement(UserIDVal, {\n      ID: value,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 23\n      }\n    })), /*#__PURE__*/React.createElement(FormGroup, {\n      id: \"charityName\",\n      labelName: \"Charity Name\",\n      value: this.state.charityName,\n      handleChange: this.handleChange(\"charityName\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      className: \"submit-button\",\n      type: \"submit\",\n      value: \"Search\",\n      onClick: this.handleSearchOrganizations,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 15\n      }\n    })))), /*#__PURE__*/React.createElement(CollapseWithHeader, {\n      title: \"Search Results\",\n      open: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(ReactTable, {\n      data: this.state.orgsList,\n      resolveData: data => {\n        return data.map(({\n          name,\n          websiteUrl,\n          phone\n        }) => {\n          return {\n            name,\n            websiteUrl,\n            phone\n          };\n        });\n      },\n      columns: [{\n        headerClassName: \"apply-table-thead\",\n        Header: \"Organization Name\",\n        accessor: \"name\",\n        style: {\n          whiteSpace: \"unset\"\n        }\n      }, {\n        headerClassName: \"apply-table-thead\",\n        Header: \"Website\",\n        accessor: \"websiteUrl\",\n        style: {\n          whiteSpace: \"unset\"\n        }\n      }, {\n        headerClassName: \"apply-table-thead\",\n        Header: \"Phone\",\n        accessor: \"phone\",\n        style: {\n          whiteSpace: \"unset\"\n        }\n      }],\n      defaultPageSize: 10,\n      getTrProps: (state, rowInfo, column) => {\n        return {\n          onClick: e => {\n            this.handleCharityClick(rowInfo.index);\n          }\n        };\n      },\n      className: \"-striped -highlight\",\n      style: {\n        height: \"400px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(CollapseWithHeader, {\n      title: \"Membership Requests\",\n      open: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(ReactTable, {\n      data: this.state.charities,\n      resolveData: data => {\n        return data.map(({\n          charityName,\n          mailingAddress,\n          category: {\n            categoryName\n          },\n          cause: {\n            causeName\n          }\n        }) => {\n          return {\n            charityName,\n            mailingAddress: this.formatAddress(mailingAddress),\n            category: categoryName,\n            cause: causeName\n          };\n        });\n      },\n      columns: [{\n        headerClassName: \"apply-table-thead\",\n        Header: \"Organization\",\n        accessor: \"charityName\",\n        style: {\n          whiteSpace: \"unset\"\n        }\n      }, {\n        headerClassName: \"apply-table-thead\",\n        Header: \"Location\",\n        accessor: \"mailingAddress\",\n        style: {\n          whiteSpace: \"unset\"\n        }\n      }, {\n        headerClassName: \"apply-table-thead\",\n        accessor: \"category\",\n        Header: \"Verified\",\n        style: {\n          whiteSpace: \"unset\"\n        }\n      }, {\n        headerClassName: \"apply-table-thead\",\n        accessor: \"cause\",\n        Header: \"Role\",\n        style: {\n          whiteSpace: \"unset\"\n        }\n      }],\n      defaultPageSize: 10,\n      className: \"-striped -highlight\",\n      style: {\n        height: \"400px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(CollapseWithHeader, {\n      title: \"Affiliations\",\n      open: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 9\n      }\n    }, this.state.charityDetailsRow[0] !== undefined ? /*#__PURE__*/React.createElement(ReactTable, {\n      data: this.state.charityDetailsRow,\n      resolveData: data => {\n        return data.map(({\n          name,\n          verified,\n          role,\n          date\n        }) => {\n          return {\n            name,\n            verified,\n            role,\n            date\n          };\n        });\n      },\n      columns: [{\n        Header: \"Active Group\",\n        accessor: \"mission\",\n        style: {\n          whiteSpace: \"unset\"\n        },\n        show: () => this.state.charityDetailsRow[0].name === \"\" ? false : true,\n        Cell: row => /*#__PURE__*/React.createElement(\"div\", {\n          className: \"col text-center\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"input\", {\n          className: \"submit-button\",\n          type: \"submit\",\n          value: this.state.representing.id == this.state.charityDetailsRow[row.index].id ? \"+\" : \"-\",\n          onClick: () => this.changeRepresentation(row.index),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 23\n          }\n        }))\n      }, {\n        Header: \"Name\",\n        accessor: \"name\",\n        style: {\n          whiteSpace: \"unset\",\n          alignItems: \"center\"\n        }\n      }, {\n        Header: \"Verified\",\n        accessor: \"verified\",\n        style: {\n          whiteSpace: \"unset\"\n        }\n      }, {\n        Header: \"Role\",\n        accessor: \"role\",\n        style: {\n          whiteSpace: \"unset\"\n        }\n      }, {\n        Header: \"Date Joined\",\n        accessor: \"date\",\n        style: {\n          whiteSpace: \"unset\"\n        }\n      }, {\n        Header: \"\",\n        accessor: \"remove\",\n        style: {\n          whiteSpace: \"unset\"\n        },\n        show: () => this.state.charityDetailsRow[0].name === \"\" ? false : true,\n        Cell: row => /*#__PURE__*/React.createElement(\"div\", {\n          className: \"col text-center\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 431,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"input\", {\n          className: \"submit-button\",\n          type: \"submit\",\n          value: \"Remove\",\n          onClick: () => this.removeMember(row.index),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 23\n          }\n        }))\n      }],\n      defaultPageSize: 10,\n      className: \"-striped -highlight\",\n      style: {\n        height: \"400px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 13\n      }\n    }) : \"\"));\n  }\n\n}\n\nexport default JoinGroup;","map":{"version":3,"sources":["/home/ubuntu/Connor/Demo_OSU_Filemanager/app/src/pages/MainPages/OrganizationPages/JoinGroup/index.js"],"names":["React","Component","ReactTable","CollapseWithHeader","UserIDContext","swal","FormGroup","labelName","value","handleChange","replace","userID","call","insert","UserIDVal","ID","JoinGroup","constructor","props","REACT_APP_AF_BACKEND_URL","process","env","window","changeRepresentation","rowNum","state","representing","charityDetailsRow","localStorage","setItem","JSON","stringify","name","r","getItem","console","log","removeMember","buttons","then","willRemove","data","FormData","append","id","role","fetch","method","body","response","ok","icon","joinedOrganizations","e","json","resData","orgs","charityVals","i","length","push","verified","date","orgID","setState","parse","handleSearchOrganizations","document","getElementById","searchVal","displayOrganizations","orgName","render","orgValues","websiteUrl","phone","orgsList","key","event","target","handleCharityClick","willJoin","handleSubmit","preventDefault","shouldHide","charityName","bind","componentDidMount","location","hash","componentDidUpdate","orgResult","map","current_info","headerClassName","Header","accessor","style","whiteSpace","rowInfo","column","onClick","index","height","charities","mailingAddress","category","categoryName","cause","causeName","formatAddress","undefined","show","Cell","row","alignItems"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\nimport ReactTable from \"react-table\";\nimport CollapseWithHeader from \"../../../../components/CollapseWithHeader\";\nimport {UserIDContext} from \"../../MainPagesRoutingContainer/index.tsx\";\nimport \"../../../../styles/buttons.css\";\nimport \"./scss/join-group.scss\";\nimport \"react-table/react-table.css\";\nimport swal from \"sweetalert\";\n\nconst FormGroup = ({ labelName, value, handleChange }) => {\n  return (\n    <div className=\"form-group row\">\n      <div className=\"col-1\" />\n      <label\n        htmlFor={labelName.replace(/\\s+/g, \"-\")}\n        className=\"col-2 col-form-label\"\n      >\n        {labelName}\n      </label>\n      <div className=\"col-8\">\n        <input\n          type=\"text\"\n          className=\"form-control\"\n          id={labelName.replace(/\\s+/g, \"-\")}\n          value={value}\n          onChange={handleChange}\n        />\n      </div>\n      <div className=\"col-1\" />\n    </div>\n  );\n};\n\nlet userID = 0;\nlet call = true;\nconst insert = true;\nconst UserIDVal = ID => {\n  userID = ID.ID;\n  return null;\n};\nclass JoinGroup extends Component {\n  REACT_APP_AF_BACKEND_URL = process.env.REACT_APP_AF_BACKEND_URL || window.REACT_APP_AF_BACKEND_URL;\n  \n  constructor(props) {\n    super(props);\n    this.state = {\n      orgsList: [{ name: \"\", websiteUrl: \"\", phone: \"\", id: 0 }],\n      shouldHide: true,\n      charityName: \"\",\n      charityDetailsRow: [\n        { name: \"\", verified: \"\", role: \"\", date: \"\", id: 0 }\n      ],\n      representing: { name: \"\", verified: \"\", role: \"\", date: \"\", id: 0 }\n    };\n    this.displayOrganizations = this.displayOrganizations.bind(this);\n    this.joinedOrganizations = this.joinedOrganizations.bind(this);\n  }\n\n  /*Helper Functions*/\n  //Updates state with what company they are representing\n  changeRepresentation = rowNum => {\n    this.state.representing = this.state.charityDetailsRow[rowNum];\n    localStorage.setItem(\n      \"representing\",\n      JSON.stringify(this.state.representing)\n    );\n    swal(\n      this.state.representing.name,\n      \"You are now representing this organization\"\n    );\n    const r = localStorage.getItem(\"representing\");\n    console.log(r);\n  };\n\n  //Removes member from organization\n  removeMember = rowNum => {\n    console.log(rowNum);\n    swal(\n      this.state.charityDetailsRow[rowNum].name,\n      \"Do you wish to remove this organization?\",\n      { buttons: [\"Cancel\", true] }\n    ).then(willRemove => {\n      if (willRemove) {\n        const data = new FormData();\n        data.append(\"orgID\", this.state.charityDetailsRow[rowNum].id);\n        data.append(\n          \"admin\",\n          this.state.charityDetailsRow[rowNum].role === \"Admin\" ? \"1\" : \"0\"\n        );\n        data.append(\"userID\", userID);\n        fetch(this.REACT_APP_AF_BACKEND_URL + \"/joinGroup/removeMember\", {\n          method: \"POST\",\n          body: data\n        })\n          .then(response => {\n            if (response.ok) {\n              swal(\"You have been removed from the organization!\", {\n                icon: \"success\"\n              });\n            } else {\n              swal(\"Failure: Group already removed\", {\n                icon: \"warning\"\n              });\n            }\n          })\n          .then(() => {});\n      }\n    });\n  };\n\n  //Displays organization affiliations\n  joinedOrganizations = e => {\n    if (call && userID != null && userID != 0) {\n      call = false;\n      const data = new FormData();\n      data.append(\"userID\", userID);\n      fetch(this.REACT_APP_AF_BACKEND_URL + \"/joinGroup/affiliations\", {\n        method: \"POST\",\n        body: data\n      })\n        .then(response => {\n          if (response.ok) return response.json();\n        })\n        .then(resData => {\n          if (resData != null && resData.orgs == null) {\n            const charityVals = [];\n            for (let i = 0; i < resData.length; i++) {\n              charityVals.push({\n                name: resData[i].name,\n                verified: resData[i].verified ? \"Yes\" : \"No\",\n                role: resData[i].role,\n                date: resData[i].date,\n                id: resData[i].orgID\n              });\n            }\n            this.setState({\n              charityDetailsRow: charityVals,\n              representing:\n                JSON.parse(localStorage.getItem(\"representing\")) ||\n                charityVals[0]\n            });\n            console.log(JSON.parse(localStorage.getItem(\"representing\")));\n          } else {\n          }\n        });\n    }\n  };\n\n  //function: Searches for organizations whose name contains the entered string\n  handleSearchOrganizations = e => {\n    console.log(\"Charity search\");\n    console.log(document.getElementById(\"Charity-Name\").value);\n    if (document.getElementById(\"Charity-Name\") != null) {\n      const searchVal = document.getElementById(\"Charity-Name\").value;\n      const data = new FormData();\n      data.append(\"orgName\", searchVal);\n      fetch(this.REACT_APP_AF_BACKEND_URL + \"/joinGroup/searchOrg\", {\n        method: \"POST\",\n        body: data\n      })\n        .then(response => {\n          if (response.ok) return response.json();\n        })\n        .then(resData => {\n          if (resData != null) {\n            console.log(\"Here are your results\");\n            this.displayOrganizations(resData.orgName);\n            this.render();\n          } else {\n            console.log(\"No organizations matched your search\");\n          }\n        });\n    }\n  };\n\n  displayOrganizations = orgs => {\n    console.log(orgs);\n    const orgValues = [];\n    for (let i = 0; i < orgs.length; i++) {\n      orgValues.push({\n        name: orgs[i].name,\n        websiteUrl: orgs[i].websiteUrl,\n        phone: orgs[i].phone,\n        id: orgs[i].ID\n      });\n    }\n    console.log(orgValues);\n    this.setState({\n      orgsList: orgValues\n    });\n    console.log(\"after displaying orgs\", this.state.orgsList);\n    this.render();\n  };\n\n  /*Handle Event Functions*/\n  handleChange = key => {\n    return event => {\n      this.setState({ [key]: event.target.value });\n    };\n  };\n\n  handleCharityClick = rowNum => {\n    swal(\n      this.state.orgsList[rowNum].name,\n      \"Do you wish to join this organization?\",\n      { buttons: [\"Cancel\", true] }\n    ).then(willJoin => {\n      if (willJoin) {\n        const data = new FormData();\n        data.append(\"orgID\", this.state.orgsList[rowNum].id);\n        data.append(\"userID\", userID);\n        fetch(this.REACT_APP_AF_BACKEND_URL + \"/joinGroup/addMember\", {\n          method: \"POST\",\n          body: data\n        })\n          .then(response => {\n            if (response.ok) {\n              swal(\"You have joined the group!\", {\n                icon: \"success\"\n              });\n              //return response.json();\n            } else {\n              swal(\"Failure: Group already joined\", {\n                icon: \"warning\"\n              });\n            }\n          })\n          .then(() => {});\n      }\n    });\n  };\n\n  handleSubmit = e => {\n    e.preventDefault();\n  };\n\n  componentDidMount() {\n    if (!window.location.hash) {\n      //setting window location\n      window.location = window.location + \"#loaded\";\n      //using reload() method to reload web page\n      // window.location.reload();\n    }\n  }\n\n  componentDidUpdate() {\n    this.joinedOrganizations();\n  }\n  render() {\n    const orgResult = this.state.orgsList.map(function(current_info) {\n      return current_info ? <li>{current_info}</li> : null;\n    });\n    return (\n      <div className=\"col\">\n        <form className=\"col\" onSubmit={this.handleSubmit}>\n          <UserIDContext.Consumer>\n            {value => <UserIDVal ID={value} />}\n          </UserIDContext.Consumer>\n          <FormGroup\n            id=\"charityName\"\n            labelName=\"Charity Name\"\n            value={this.state.charityName}\n            handleChange={this.handleChange(\"charityName\")}\n          />\n          <div className=\"form-group row\">\n            <div className=\"col text-center\">\n              <input\n                className=\"submit-button\"\n                type=\"submit\"\n                value=\"Search\"\n                onClick={this.handleSearchOrganizations}\n              />\n            </div>\n          </div>\n        </form>\n        <CollapseWithHeader title=\"Search Results\" open={true}>\n          <ReactTable\n            data={this.state.orgsList}\n            resolveData={data => {\n              return data.map(({ name, websiteUrl, phone }) => {\n                return { name, websiteUrl, phone };\n              });\n            }}\n            columns={[\n              {\n                headerClassName: \"apply-table-thead\",\n                Header: \"Organization Name\",\n                accessor: \"name\",\n                style: { whiteSpace: \"unset\" }\n              },\n              {\n                headerClassName: \"apply-table-thead\",\n                Header: \"Website\",\n                accessor: \"websiteUrl\",\n                style: { whiteSpace: \"unset\" }\n              },\n              {\n                headerClassName: \"apply-table-thead\",\n                Header: \"Phone\",\n                accessor: \"phone\",\n                style: { whiteSpace: \"unset\" }\n              }\n            ]}\n            defaultPageSize={10}\n            getTrProps={(state, rowInfo, column) => {\n              return {\n                onClick: e => {\n                  this.handleCharityClick(rowInfo.index);\n                }\n              };\n            }}\n            className=\"-striped -highlight\"\n            style={{\n              height: \"400px\"\n            }}\n          />\n        </CollapseWithHeader>\n        <CollapseWithHeader title=\"Membership Requests\" open={true}>\n          <ReactTable\n            data={this.state.charities}\n            resolveData={data => {\n              return data.map(\n                ({\n                  charityName,\n                  mailingAddress,\n                  category: { categoryName },\n                  cause: { causeName }\n                }) => {\n                  return {\n                    charityName,\n                    mailingAddress: this.formatAddress(mailingAddress),\n                    category: categoryName,\n                    cause: causeName\n                  };\n                }\n              );\n            }}\n            columns={[\n              {\n                headerClassName: \"apply-table-thead\",\n                Header: \"Organization\",\n                accessor: \"charityName\",\n                style: { whiteSpace: \"unset\" }\n              },\n              {\n                headerClassName: \"apply-table-thead\",\n                Header: \"Location\",\n                accessor: \"mailingAddress\",\n                style: { whiteSpace: \"unset\" }\n              },\n              {\n                headerClassName: \"apply-table-thead\",\n                accessor: \"category\",\n                Header: \"Verified\",\n                style: { whiteSpace: \"unset\" }\n              },\n              {\n                headerClassName: \"apply-table-thead\",\n                accessor: \"cause\",\n                Header: \"Role\",\n                style: { whiteSpace: \"unset\" }\n              }\n            ]}\n            defaultPageSize={10}\n            className=\"-striped -highlight\"\n            style={{\n              height: \"400px\"\n            }}\n          />\n        </CollapseWithHeader>\n\n        <CollapseWithHeader title=\"Affiliations\" open={true}>\n          {this.state.charityDetailsRow[0] !== undefined ? (\n            <ReactTable\n              data={this.state.charityDetailsRow}\n              resolveData={data => {\n                return data.map(({ name, verified, role, date }) => {\n                  return { name, verified, role, date };\n                });\n              }}\n              columns={[\n                {\n                  Header: \"Active Group\",\n                  accessor: \"mission\",\n                  style: { whiteSpace: \"unset\" },\n                  show: () =>\n                    this.state.charityDetailsRow[0].name === \"\" ? false : true,\n                  Cell: row => (\n                    <div className=\"col text-center\">\n                      <input\n                        className=\"submit-button\"\n                        type=\"submit\"\n                        value={\n                          this.state.representing.id ==\n                          this.state.charityDetailsRow[row.index].id\n                            ? \"+\"\n                            : \"-\"\n                        }\n                        onClick={() => this.changeRepresentation(row.index)}\n                      />\n                    </div>\n                  )\n                },\n                {\n                  Header: \"Name\",\n                  accessor: \"name\",\n                  style: { whiteSpace: \"unset\", alignItems: \"center\" }\n                },\n                {\n                  Header: \"Verified\",\n                  accessor: \"verified\",\n                  style: { whiteSpace: \"unset\" }\n                },\n                {\n                  Header: \"Role\",\n                  accessor: \"role\",\n                  style: { whiteSpace: \"unset\" }\n                },\n                {\n                  Header: \"Date Joined\",\n                  accessor: \"date\",\n                  style: { whiteSpace: \"unset\" }\n                },\n                {\n                  Header: \"\",\n                  accessor: \"remove\",\n                  style: { whiteSpace: \"unset\" },\n                  show: () =>\n                    this.state.charityDetailsRow[0].name === \"\" ? false : true,\n                  Cell: row => (\n                    <div className=\"col text-center\">\n                      <input\n                        className=\"submit-button\"\n                        type=\"submit\"\n                        value=\"Remove\"\n                        onClick={() => this.removeMember(row.index)}\n                      />\n                    </div>\n                  )\n                }\n              ]}\n              defaultPageSize={10}\n              className=\"-striped -highlight\"\n              style={{\n                height: \"400px\"\n              }}\n            />\n          ) : (\n            \"\"\n          )}\n        </CollapseWithHeader>\n      </div>\n    );\n  }\n}\nexport default JoinGroup;\n"]},"metadata":{},"sourceType":"module"}