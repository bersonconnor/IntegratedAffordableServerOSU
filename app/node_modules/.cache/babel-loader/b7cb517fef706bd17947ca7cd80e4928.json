{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/Connor/WorkOSU/app/src/pages/AuthPages/ChangePrimaryEmailVerify/index.js\";\nimport React, { Component } from \"react\";\nimport queryString from \"query-string\";\n\nclass ChangePrimaryEmailVerify extends Component {\n  constructor(props) {\n    super(props);\n    this.REACT_APP_AF_BACKEND_URL = process.env.REACT_APP_AF_BACKEND_URL || window.REACT_APP_AF_BACKEND_URL;\n    this.state = {\n      username: \"\",\n      newEmail: \"\",\n      oldEmail: \"\",\n      randomString: \"\",\n      timestamp: \"\"\n    };\n    this.handleEmailChange = this.handleEmailChange.bind(this);\n  }\n\n  handleEmailChange() {\n    var tenMinutes = 1000000;\n\n    if (Date.now() - this.state.timestamp < tenMinutes) {\n      var newEmail = this.state.newEmail;\n      var oldEmail = this.state.oldEmail;\n      var data = new FormData();\n      data.append(\"newEmail\", newEmail);\n      data.append(\"oldEmail\", oldEmail);\n      fetch(this.REACT_APP_AF_BACKEND_URL + \"/profile/update-email\", {\n        method: \"POST\",\n        body: data\n      }).then(response => {\n        if (response.ok) return response.json().then(resData => {\n          alert(resData.success);\n        });else {\n          alert(\"unable to change email\");\n        }\n      });\n    } else {\n      var data2 = new FormData();\n      data2.append(\"randomstring\", this.state.randomString);\n      fetch(this.REACT_APP_AF_BACKEND_URL + \"/profile/remove-request\", {\n        method: \"POST\",\n        body: data2\n      }).then(response => {\n        if (response.ok) return response.json().then(() => {\n          alert(\"Secret string expired\");\n        });\n      });\n    }\n  }\n\n  componentDidMount() {\n    var decodedURL = decodeURIComponent(this.props.location.search);\n    var values = queryString.parse(decodedURL);\n    var randomString = values.temp;\n    console.log(\"string: \" + randomString);\n    var rdata = new FormData();\n    rdata.append(\"randomString\", randomString);\n    var that = this;\n    fetch(this.REACT_APP_AF_BACKEND_URL + \"/profile/get-request\", {\n      method: \"POST\",\n      body: rdata\n    }).then(response => {\n      console.log(response);\n      if (response.ok) return response.json().then(resData => {\n        if (resData.RandomString === randomString) {\n          that.setState({\n            username: resData.Username,\n            newEmail: resData.NewEmail,\n            oldEmail: resData.OldEmail,\n            randomString: resData.RandomString,\n            timestamp: resData.Timestamp\n          });\n          that.handleEmailChange();\n        }\n      });else {\n        alert(\"unable to change email\");\n      }\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row mt-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 15\n      }\n    }, \"Your New Email has been Verified!\")))));\n  }\n\n}\n\nexport default ChangePrimaryEmailVerify;","map":{"version":3,"sources":["/home/ubuntu/Connor/WorkOSU/app/src/pages/AuthPages/ChangePrimaryEmailVerify/index.js"],"names":["React","Component","queryString","ChangePrimaryEmailVerify","constructor","props","REACT_APP_AF_BACKEND_URL","process","env","window","state","username","newEmail","oldEmail","randomString","timestamp","handleEmailChange","bind","tenMinutes","Date","now","data","FormData","append","fetch","method","body","then","response","ok","json","resData","alert","success","data2","componentDidMount","decodedURL","decodeURIComponent","location","search","values","parse","temp","console","log","rdata","that","RandomString","setState","Username","NewEmail","OldEmail","Timestamp","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport queryString from \"query-string\";\n\nclass ChangePrimaryEmailVerify extends Component {\n\n  REACT_APP_AF_BACKEND_URL = process.env.REACT_APP_AF_BACKEND_URL || window.REACT_APP_AF_BACKEND_URL;\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      username: \"\",\n      newEmail: \"\",\n      oldEmail: \"\",\n      randomString: \"\",\n      timestamp: \"\"\n    };\n\n    this.handleEmailChange = this.handleEmailChange.bind(this);\n  }\n\n  handleEmailChange() {\n    const tenMinutes = 1000000;\n    if (Date.now() - this.state.timestamp < tenMinutes) {\n      const newEmail = this.state.newEmail;\n      const oldEmail = this.state.oldEmail;\n\n      const data = new FormData();\n      data.append(\"newEmail\", newEmail);\n      data.append(\"oldEmail\", oldEmail);\n\n      fetch(this.REACT_APP_AF_BACKEND_URL +\"/profile/update-email\", {\n        method: \"POST\",\n        body: data\n      }).then(response => {\n        if (response.ok)\n          return response.json().then(resData => {\n            alert(resData.success);\n          });\n        else {\n          alert(\"unable to change email\");\n        }\n      });\n    } else {\n      const data2 = new FormData();\n      data2.append(\"randomstring\", this.state.randomString);\n      fetch(this.REACT_APP_AF_BACKEND_URL + \"/profile/remove-request\", {\n        method: \"POST\",\n        body: data2\n      }).then(response => {\n        if (response.ok)\n          return response.json().then(() => {\n            alert(\"Secret string expired\");\n          });\n      });\n    }\n  }\n\n  componentDidMount() {\n    const decodedURL = decodeURIComponent(this.props.location.search);\n    const values = queryString.parse(decodedURL);\n    const randomString = values.temp;\n    console.log(\"string: \" + randomString);\n\n    const rdata = new FormData();\n    rdata.append(\"randomString\", randomString);\n\n    const that = this;\n    fetch(this.REACT_APP_AF_BACKEND_URL + \"/profile/get-request\", {\n      method: \"POST\",\n      body: rdata\n    }).then(response => {\n      console.log(response);\n      if (response.ok)\n        return response.json().then(resData => {\n          if (resData.RandomString === randomString) {\n            that.setState({\n              username: resData.Username,\n              newEmail: resData.NewEmail,\n              oldEmail: resData.OldEmail,\n              randomString: resData.RandomString,\n              timestamp: resData.Timestamp\n            });\n            that.handleEmailChange();\n          }\n        });\n      else {\n        alert(\"unable to change email\");\n      }\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"row mt-5\">\n        <div className=\"col\">\n          <div className=\"row\">\n            <div className=\"col text-center\">\n              <h1>Your New Email has been Verified!</h1>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ChangePrimaryEmailVerify;\n"]},"metadata":{},"sourceType":"module"}